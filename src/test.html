<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  <script>
    async function main() {
      if (!navigator.geolocation) {
        // alert('Thiết bị không hỗ trợ truy cập vị trí');
        navigate(`/${encodeURI('ho-chi-minh')}`);
        return;
      }
      await navigator.geolocation.getCurrentPosition(
        async (position) => {
          let latitude = position.coords.latitude;
          let longitude = position.coords.longitude;
          try {
            let url = `http://localhost:3000/geocode`;
            const response = await fetch(url, {
              headers: {
                "Content-type": "application/json; charset=UTF-8"
              },
              mode: "cors",
              method: 'POST',
              body: JSON.stringify({
                lat: latitude,
                lon: longitude,
              }),
            });
            if (!response.ok) {
              throw new Error(`Response status: ${response.status}`);
            }
            console.log(response)
            const data = await response.json();
            console.log(data)
          } catch (error) {
            if (error instanceof DOMException) {
              return;
            }
            console.error(error);
            // alert('Khong lay duoc vi tri!')
          }
        },
        (err) => {
          if (err.PERMISSION_DENIED) {
            // alert('Hãy bật truy cập vị trí');
          }
        }
      );
    }
    main()
  </script>
</body>

</html>